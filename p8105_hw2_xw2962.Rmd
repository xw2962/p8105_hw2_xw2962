---
title: "p8105_hw2_xw2962"
author: "Xiaoyu Wu"
date: "2023-09-26"
output: github_document
---

```{r setup}
library(tidyverse)
library(haven)
library(readxl)
```

## Problem One 

#### Step One: Clean Data in `pols-month.csv`

```{r}
pols_df = 
  read_csv("./fivethirtyeight_datasets/pols-month.csv") |> 
  janitor::clean_names() |> 
# Read in dataset 
  separate(mon, into = c("year", "month_day"), sep = 4) |>
  separate(month_day, into = c("month","day"), sep = 3) |>
# Use separate() to break up the variable mon into integer variables year, month, and day
  mutate(month = recode(month, "-01" = "jan", "-02" = "feb","-03" = "mar","-04" = "apr","-05" = "may","-06" = "jun","-07" = "jul","-08" = "aug","-09" = "sep","-10" = "oct","-11" = "nov","-12" = "dec")) |> 
# Replace month number with month name 
  mutate(day=recode(day,"-15"="15")) |>
  relocate(year, month,day,prez_gop,prez_dem) |>
  pivot_longer(
   prez_gop:prez_dem,
   names_to = "president",
   names_prefix = "prez_"
   ) |>
   select(-value)|>
# Create a president variable taking values gop and dem, and remove prez_dem and prez_gop
   select(-day)
# Remove the day variable
pols_df
```

#### Step Two: Clean Data in `snp.csv`

```{r}
snp_df = 
  read_csv("./fivethirtyeight_datasets/snp.csv") |> 
  janitor::clean_names() |> 
# Read in dataset 
  separate(date, into = c("month", "day_year"), sep = 2) |>
  separate(day_year, into = c("day","year"), sep = 2) |>
# Use separate() to break up the variable mon into integer variables year, month, and day
  mutate(month = recode(month, "1/" = "jan", "2/" = "feb","3/" = "mar","4/" = "apr","5/" = "may","6/" = "jun","7/" = "jul","8/" = "aug","9/" = "sep","10" = "oct","11" = "nov","12" = "dec")) |> 
# Replace month number with month name
  select(-day) |> 
# Remove the day variable
  arrange(year, month) |>
# Arrange according to year and month
  relocate(year, month) |>
# Organize so that year and month are the leading columns
  separate(year, into = c("null", "year"), sep = 1) |>
  select(-null)
# Remove prefix "/" in the column "year"
snp_df
```

#### Step Three: Tidy Data in `unemployment.csv`

```{r}
unemployment_df = 
  read_csv("./fivethirtyeight_datasets/unemployment.csv") |> 
  janitor::clean_names() |>
  pivot_longer(
   jan:dec,
   names_to = "month",
   values_to = "unemployment_num"
   ) |>
  mutate(year=as.character("year"))
# mutate year from dbl to character 
unemployment_df
```

#### Join Datasets

```{r}
pols_snp = 
  left_join(pols_df,snp_df,by = "year","month")
pols_snp
# Join the datasets by merging snp into pols
pols_snp_unemployment=
  left_join(pols_snp,unemployment_df,by = "year","month")
pols_snp_unemployment
```

#### Short Description of Dataset

Dataset "pols_df" has 9 variables: `r colnames(pols_df)`. In this dataset, there are `r nrow(pols_df)` rows. And there are `r ncol(pols_df)` columns. Here we consider variables "gov_gop", "sen_gop", "rep_gop", "gov_dem", "sen_dem", "rep_dem" and "president" to be important for analysis.

Dataset "snp_df" has 3 variables: `r colnames(snp_df)`. In this dataset, there are `r nrow(snp_df)` rows. And there are `r ncol(snp_df)` columns. Here we consider variables "close" to be important for analysis.

Dataset "unemployment_df" has 3 variables: `r colnames(unemployment_df)`. In this dataset, there are `r nrow(unemployment_df)` rows. And there are `r ncol(unemployment_df)` columns. Here we consider variables "unemployment_num" to be important for analysis.

The joining dataset "pols_snp_unemployment" has 13 variables: `r colnames(pols_snp_unemployment)`. In this dataset, there are `r nrow(pols_snp_unemployment)` rows. And there are `r ncol(pols_snp_unemployment)` columns. Here we consider variables "gov_gop", "sen_gop", "rep_gop", "gov_dem", "sen_dem", "rep_dem", "president","close" and "unemployment_num" to be important for analysis.

## Problem Two

#### Import, Clean, and Organize the Data for Mr. Trash Wheel
```{r}
mr_trash_wheel_df=
  read_excel("./Trash Wheel Data.xlsx",range="A2:N549") |> 
# Specify the sheet in the Excel file and to omit non-data entries using arguments in read_excel
  janitor::clean_names() |>  
# Use reasonable variable names
  drop_na() |> 
# Omit rows that do not include dumpster-specific data
  mutate(
    homes_powered = ((weight_tons*500)/30
    )) |>
# Update the data to include a new homes_powered variable based on the noted calculation
  mutate(trash_wheel_name="mr_trash_wheel") |>
  relocate(trash_wheel_name)
# Add a variable for Clear Identification 
mr_trash_wheel_df
```

#### Import, Clean, and Organize the Data for Professor Trash Wheel

```{r}
professor_trash_wheel_df=
  read_excel("./Trash Wheel Data.xlsx",2,range="A2:M96") |> 
# Specify the sheet in the Excel file and to omit non-data entries using arguments in read_excel
  janitor::clean_names() |>  
# Use reasonable variable names
  drop_na() |> 
# Omit rows that do not include dumpster-specific data
  mutate(
    homes_powered = ((weight_tons*500)/30
    )) |> 
# Update the data to include a new homes_powered variable based on the noted calculation
  mutate(trash_wheel_name="professor_trash_wheel") |>
  relocate(trash_wheel_name) |> 
# Add a variable for Clear Identification
  mutate(year=as.character("year"))
professor_trash_wheel_df
```

#### Import, Clean, and Organize the Data for Gwynnda Trash Wheel

```{r}
Gwynnda_trash_wheel_df=
  read_excel("./Trash Wheel Data.xlsx",4,range="A2:K108") |> 
# Specify the sheet in the Excel file and to omit non-data entries using arguments in read_excel
  janitor::clean_names() |>  
# Use reasonable variable names
  drop_na() |> 
# Omit rows that do not include dumpster-specific data
  mutate(
    homes_powered = ((weight_tons*500)/30
    )) |> 
# Update the data to include a new homes_powered variable based on the noted calculation
  mutate(trash_wheel_name="Gwynnda_trash_wheel") |>
  relocate(trash_wheel_name)
# Add a variable for Clear Identification
Gwynnda_trash_wheel_df
```

#### Combine these with the Mr. Trash Wheel Dataset to Create Single  Tidy Dataset

```{r}
mr_professor_Gwynnda=
  left_join(mr_trash_wheel_df,professor_trash_wheel_df,Gwynnda_trash_wheel_df,by=c("trash_wheel_name","month","dumpster","year","date","weight_tons","volume_cubic_yards","plastic_bottles","polystyrene","cigarette_butts","glass_bottles","grocery_bags","chip_bags","homes_powered"))
mr_professor_Gwynnda
```

#### Description

Dataset "mr_professor_Gwynnda" has 15 variables: `r colnames(mr_professor_Gwynnda)`. In this dataset, there are `r nrow(mr_professor_Gwynnda)` rows or observations. And there are `r ncol(mr_professor_Gwynnda)` columns or variables. 

Here, we consider "weight_tons","volume_cubic_yards" and "homes_powered" to be key variables. The variable "weight_tons" has mean `r mean(mr_professor_Gwynnda$weight_tons)` and standard deviation `r sd(mr_professor_Gwynnda$weight_tons)`. The variable "volume_cubic_yards" has mean `r mean(mr_professor_Gwynnda$volume_cubic_yards)` and standard deviation `r sd(mr_professor_Gwynnda$volume_cubic_yards)`. The variable "homes_powered" has mean `r mean(mr_professor_Gwynnda$homes_powered)` and standard deviation `r sd(mr_professor_Gwynnda$homes_powered)`. 

The total weight of trash collected by Professor Trash Wheel is `r sum(professor_trash_wheel_df$weight_tons)`. 

The total number of cigarette butts collected by Gwynnda in July of 2021 is `r sum(Gwynnda_trash_wheel_df$cigerette_butts)`.  

