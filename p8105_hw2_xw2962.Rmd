---
title: "p8105_hw2_xw2962"
author: "Xiaoyu Wu"
date: "2023-09-26"
output: github_document
---

```{r setup}
library(tidyverse)
library(haven)
```

## Problem One 

#### Step One: Clean Data in `pols-month.csv`

```{r}
pols_df = 
  read_csv("./fivethirtyeight_datasets/pols-month.csv") |> 
  janitor::clean_names() |> 
# Read in dataset 
  separate(mon, into = c("year", "month_day"), sep = 4) |>
  separate(month_day, into = c("month","day"), sep = 3) |>
# Use separate() to break up the variable mon into integer variables year, month, and day
  mutate(month = recode(month, "-01" = "jan", "-02" = "feb","-03" = "mar","-04" = "apr","-05" = "may","-06" = "jun","-07" = "jul","-08" = "aug","-09" = "sep","-10" = "oct","-11" = "nov","-12" = "dec")) |> 
# Replace month number with month name 
  mutate(day=recode(day,"-15"="15")) |>
  relocate(year, month,day,prez_gop,prez_dem) |>
  pivot_longer(
   prez_gop:prez_dem,
   names_to = "president",
   names_prefix = "prez_"
   ) |>
   select(-value)|>
# Create a president variable taking values gop and dem, and remove prez_dem and prez_gop
   select(-day)
# Remove the day variable
pols_df
```

#### Step Two: Clean Data in `snp.csv`

```{r}
snp_df = 
  read_csv("./fivethirtyeight_datasets/snp.csv") |> 
  janitor::clean_names() |> 
# Read in dataset 
  separate(date, into = c("month", "day_year"), sep = 2) |>
  separate(day_year, into = c("day","year"), sep = 2) |>
# Use separate() to break up the variable mon into integer variables year, month, and day
  mutate(month = recode(month, "1/" = "jan", "2/" = "feb","3/" = "mar","4/" = "apr","5/" = "may","6/" = "jun","7/" = "jul","8/" = "aug","9/" = "sep","10" = "oct","11" = "nov","12" = "dec")) |> 
# Replace month number with month name
  select(-day) |> 
# Remove the day variable
  arrange(year, month) |>
# Arrange according to year and month
  relocate(year, month) |>
# Organize so that year and month are the leading columns
  separate(year, into = c("null", "year"), sep = 1) |>
  select(-null)
# Remove prefix "/" in the column "year"
snp_df
```

#### Step Three: Tidy Data in `unemployment.csv`

```{r}
unemployment_df = 
  read_csv("./fivethirtyeight_datasets/unemployment.csv") |> 
  janitor::clean_names() |>
  pivot_longer(
   jan:dec,
   names_to = "month",
   values_to = "unemployment_num"
   ) |>
  mutate(year=as.character("year"))
# mutate year from dbl to character 
unemployment_df
```

#### Join Datasets

```{r}
pols_snp = 
  left_join(pols_df,snp_df,by = "year","month")
pols_snp
# Join the datasets by merging snp into pols
pols_snp_unemployment=
  left_join(pols_snp,unemployment_df,by = "year","month")
pols_snp_unemployment
```

#### Short Description of Dataset

Dataset "pols_df" has 9 variables: `r colnames(pols_df)`. In this dataset, there are `r nrow(pols_df)` rows. And there are `r ncol(pols_df)` columns. Here we consider variables "gov_gop", "sen_gop", "rep_gop", "gov_dem", "sen_dem", "rep_dem" and "president" to be important for analysis.

Dataset "snp_df" has 3 variables: `r colnames(snp_df)`. In this dataset, there are `r nrow(snp_df)` rows. And there are `r ncol(snp_df)` columns. Here we consider variables "close" to be important for analysis.

Dataset "unemployment_df" has 3 variables: `r colnames(unemployment_df)`. In this dataset, there are `r nrow(unemployment_df)` rows. And there are `r ncol(unemployment_df)` columns. Here we consider variables "unemployment_num" to be important for analysis.

The joining dataset "pols_snp_unemployment" has 13 variables: `r colnames(pols_snp_unemployment)`. In this dataset, there are `r nrow(pols_snp_unemployment)` rows. And there are `r ncol(pols_snp_unemployment)` columns. Here we consider variables "gov_gop", "sen_gop", "rep_gop", "gov_dem", "sen_dem", "rep_dem", "president","close" and "unemployment_num" to be important for analysis.



